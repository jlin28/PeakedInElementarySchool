<!DOCTYPE html>

<!--
Joyce Lin, Evan Khosh, Sean Zheng, Zixi Qiao
PIES
SoftDev
P01 -- ArRESTed Development
TBD
-->

<html>

  <head>
    <title> WINNER </title>

    <!-- CUSTOM CSS -->
    <link rel="stylesheet"
      type="text/css"
      href="/static/css/style.css">

    <!-- BOOTSTRAP CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">

    <!-- PAGE SPECIFIC CSS -->
    <style>
      /* BACKGROUND */
      body {
        background-repeat: no-repeat;
        background-size: 100vw 100vh;
        font-family: font;
      }

      /* MAIN CONTAINER */
      #main {
        height:45vh;
        width: 65vw;

        border-radius: 25px;

        background-color: rgba(255,255,255,0.5);
      }

      /* BUTTONS */
      button {
        font-family: font;
        font-size: 145%;
        background: none;

        width:35%;

        border-style: solid;
        border-width: medium;
        border-color: black;

        transform: scale(130%);
      }

      button:hover:not(.noTransform) {
        transform: scale(140%);
      }

      /* MODAL */
      .modal-dialog, .modal-content {
        height:90%;
      }

      .slides {
        display: flex;
        flex-direction: row;

        align-items: center;
        justify-content: center;
      }

      .noTransform:not(.close) {
        transform: scale(200%);
        height: 10%;
        width: 20%;
        border-style: none;
      }

      /* BOARD */
      .board {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);

        width: 400px;
        height:auto;
      }

      #images {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50.5%);

        width: 400px;
        height: 402px;
      }

      .row {
        height: 12.52%;
      }

      .col {
        width:15px;
        height: 100%;
      }

      .piece {
        width: 75px;
        height: auto;
        overflow: hidden;

        margin-left: -23px;
        margin-top: -14px;
      }

    </style>
  </head>

  <body>
    <form id="play" method="POST" action="/"> </form>

    <div style="margin-top:10vh;" id='main' class="container">
      <div id='title' class='center container' style="text-align:center">
        <p style='font-size:400%;'> {{ winner }} &nbsp&nbsp WINS </p>
      </div>
      <hr style="border-width:medium;margin-top:-2%;width:60%;" class='center'>
      <div style="margin-top:-50px; width:50%" class="container">
        <button type="submit" form="play" name="restart" value="restart" class="center" style="margin-top:18%;">
                MENU
        </button>
        <button type="button" form="play" class="center" style="margin-top: 8%;" data-bs-toggle="modal" data-bs-target="#replay">
          REPLAY
        </button>
      </div>
    </div>

    <!-- MODAL + REPLAY STUFF -->
    <div class="modal fade" id="replay" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content">
          <br>
          <h3 class="center" style="font-size:300%" class="modal-title" id="staticBackdropLabel"> tbd </h1>
          <br>
          <div class="modal-body" style="display:flex;flex-direction:row;margin-top:-30px;background-color:rgba(0,0,0,0.2)">
            <!-- REPLAY SYSTEM -->
            <div class='slides' style='width:20%;'>
              <button type="button" class="bi bi-caret-left-fill noTransform"></p>
            </div>
            <!------------ BOARD IMAGES ------------>
            <div class='slides' style='width:60%;'>
              <img src="/static/images/plainBoard.jpg" class="board">
              <div id="images" class="container">
                {% set pieces = ['rook', 'knight', 'bishop', 'queen', 'king','pawn'] %}
                {% set gridlabel = ['a','b','c','d','e','f','g','h'] %}
                {% for ROW in board %}
                  <div class="row">
                    {% set index = loop.index0 %}
                    {% for COL in ROW %}
                      <div class="col image {{ gridlabel[loop.index0] }}{{ index }}">
                        {% if COL < 0 %}
                          <img class="center black piece {{ pieces[COL|abs - 1] }}"
                                src="/static/sprites/black/{{ pieces[COL|abs - 1] }}/idle.png"
                                alt="{{ pieces[COL|abs - 1] }}">
                        {% elif COL > 0 %}
                          <img class="center white piece {{ pieces[COL|abs - 1] }}"
                                src="/static/sprites/white/{{ pieces[COL - 1] }}/idle.png"
                                alt="{{ pieces[COL - 1]}}">
                        {% endif %}
                      </div>
                    {% endfor %}
                  </div>
                {% endfor %}
              </div>
            </div>
            <!-- ---------------------- -->
            <div class='slides' style='width:20%;'>
              <button type="button" class="bi bi-caret-right-fill noTransform"></button>
            </div>
          </div>
          <br>
          <button type="button" class="noTransform center close" style="width:15%;transform:scale(110%);" data-bs-dismiss="modal" aria-label="Close"> exit </button>
          <br>
        </div>
      </div>
    </div>

    <!-- BOOTSTRAP JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
      crossorigin="anonymous"> </script>

    <!-- PAGE-SPECIFIC JS -->
    <script>
      var winner = "{{ winner }}";
      console.log(winner);

      window.onload = function() {
        console.log('run');
        if (winner == 'white') {
          document.body.style.backgroundImage = "url('/static/images/whiteWin.jpg')";
        } else {
          document.body.style.backgroundImage = "url('/static/images/blackWin.jpg')";
        }
      };

      var move = function() {
        /* prev */
        /* next */
      };
    </script>
  </body>

</html>
